require "spec_helper"


RSpec.describe Rbshodan::API::Exploits do
    before do
        @client = Rbshodan.api.exploits.new
    end

    before(:each) do
        sleep 3
    end

    describe '#search' do
        def check
            if Async::Task.current?
                resp = @client.search("SQL", port: 443).wait
            else
                resp = @client.search("SQL", port: 443)
            end
            expect(resp).to be_a(Hash)
        end

        describe 'search across a veriety of data source for exploits' do
            it 'works synchronously' do
                check
            end
            
